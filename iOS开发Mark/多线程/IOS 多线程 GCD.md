# iOS 多线程 GCD

## 应用场景
* 网络请求
* 图片加载
* 数据存储
* 任务执行
* 文件处理
* 耗时操作等等
## 进程

我们可以把每个独立运行的应用程序理解为一个正在运行的进程, 操作系统不一致同时支持运行的进程数也不一致, 如单核操作系统就只支持运行一个进程, 运行的每个进程都是在系统分配的一份独立的内存空间中运行, 占用着系统一定的 CPU, 每个进程之间都是相互独立, 不可相互访问之间的资源的。
系统将每个进程隔离开.

* 进程的五态模型
1. 新建
2. 就绪
3. 运行
4. 阻塞
5. 终止
6. ![FhPZsx.png](https://s1.ax1x.com/2018/12/30/FhPZsx.png)
## 线程

线程是进程基本执行单元, 进程的所有任务都在线程上执行,一个进程中可以根据操作系统分配开辟多个子线程来执行任务。
## 执行: 同步与异步
## 同步

会阻塞当前线程, 不会开辟新的线程去执行任务。 继续在当前任务上进行相应任务。
## 异步
不会阻塞当前线程, 会在当前线程基础上开辟新的子线程, 去执行相应的任务。
## 队列
队列是在 GCD 和 NSOperation 引出的概念. 其主要表示 线程里面的任务, 执行的先后顺序, 和同步异步概念不一致。 一个是决定线程如何工作, 一个是决定线程内任务如何执行工作。
## 串行
线程内的所有任务都由一个队列来进行管理,如果一个线程中有个多任务要执行, 则每个任务都会按执行顺序来执行。 一个执行完毕之后在到下一个。
## 并行
如果是并行的队列, 则此线程中多个任务可同时执行。 不必等待其他任务结束即可开始执行。
## 优点
* 简化了编程模型
* 提高编程效率
* 更加的轻量级
* 提高资源利用率
## 缺点
* 增加程序复杂性(由于使用异步并发, 同时读取或者写入一份数据库时, 如果管理不佳容易导致我们获取到的值不是我们预期的)
* 占用内存空间(滥用多线程导致)
* 增大 CPU 调度 

## 多线程实现方案

* pThread
* NSThread
  通过封装 pThread 实现, 可以直接通过 OC 面向对象的方式来进行调用。
  通常有三种方式来创建, 使用。
  1. alloc init
  2. detachNewThreadSelector:toTarget:withObject
  3. @interface NSObject (NSThreadPerformAdditions) 系统将已经写好在 NSObject 分类里面。
* GCD
* NSOperation

## 线程锁

使用同步锁或者条件判定来解决线程资源共享问题。
* NSCondition
* @synchronized
当同时多两个异步线程都在执行一个任务时, 如果当前任务里面包含一些共同访问的资源,同时发生读写操作则,很容易导致数据无法保证准确同步的情况。这时我们可以使用同步锁来解决。 在执行任务前,将其锁住,等待任务结束只有在将其打开。 保证每次任务都只有一个线程在执行。

##  GCD

group








## 参考

[多线程指南](https://bestswifter.com/multithreadconclusion/)

