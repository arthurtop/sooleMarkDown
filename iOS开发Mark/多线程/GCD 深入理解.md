# GCD

## 简介 

GCD 是 Apple 为多线程技术提供的一种解决方案, 也是替代 NSThread 的一种更为高效和强大解决技术 , 其能根据操作系统的可用处理资源来调度处理器核心去执行工作, 让 CPU 能更高效率的工作,  并且 GCD 相对来说还是更加轻量级, 易于使用的。 Apple 推荐我们使用 GCD 来实现多线程技术。

## 重要概念

* 同步与异步(sync & async)

  同步与异步都是用于分配任务到相应的队列中的一种执行方式. 分配的不同方式系统会根据当前可用资源来进行相应的资源分配。
  
  **每个任务指的就是 Block 内的代码块** 
  
  两种执行方式最本质的上区别在于
  **同步会阻塞当前上下文所运行的线程中所使用队列的任务,没有开辟子线程去执行任务的功能**
  **异步不会阻塞当前上下文所运行的线程中使用队列的任务,有开辟子线程去执行任务的功能**
  
* 串行并行队列(dispatch_queue)
	
	串行与并行队列是指不考虑同步与异步的方式添加到队列当中的任务, 一种去执行的方式.
	也就是说, 你把相应的任务添加到了一条串行队列中, 那么你就必须要遵守串行的规则来执行, 1条任务接着一条任务来执行。
	
	**队列特性:** 队列遵守FIFO(先进先出)的特性, 即不管是串行队列还是并行队列, 都是先添加的任务, 然后最先退出队列. 但是并不代表最先添加的任务就保证第一个执行完,只能保证你的进入顺序与退出顺序一致。
	
## 功能

* 自动管理线程生命周期
* 轻松开辟子线程, 并发执行任务(dispatch_async(<#dispatch_queue_t  _Nonnull queue#>, <#^(void)block#>))
* 提供栅栏防护方法(dispatch_barrier_async), 保证线程同步
* 提供快速迭代方法(dispatch_apply)
* 提供队列组(dispatch_group_t), 实现异步并发同步
* 提供信号量(semaphore), 来对系统资源实现更合理的分配
* 提供设置同一队列任务优先级(dispatch_get_global_queue(<#long identifier#>, <#unsigned long flags#>))
* 延迟执行 (dispatch_after)

## dispatch_barrier_async()

* 怎样利用 GCD 实现多读单写

1. 需要满足并发读取。
2. 满足在读取过程中, 不允许写入。
3. 满足在写入过程中, 不允许读取。
4. 满足在写入过程中, 不允许写入。

dispatch_barrier_async()  提供了这种功能。

它会阻塞住当前 并行队列添加任务. 直到此条任务执行完之后, 才会执行下一个任务。


## dispatch_group_async()


dispatch_group_notify


